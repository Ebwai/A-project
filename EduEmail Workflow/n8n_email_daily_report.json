{
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "30 22 * * *"
            }
          ]
        }
      },
      "id": "63875a77-804f-4718-90b6-6ae1ef70c7b9",
      "name": "æ¯å¤© 22:30 è§¦å‘",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [
        -1264,
        112
      ]
    },
    {
      "parameters": {
        "command": "cat /files/daily_emails.jsonl || echo \"\""
      },
      "id": "d40ccb4c-8cba-4890-99af-2f00d8a77048",
      "name": "è¯»å–æš‚å­˜æ–‡ä»¶",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -816,
        112
      ]
    },
    {
      "parameters": {
        "jsCode": "let raw = $input.first().json.stdout || \"\";\nlet emails = [];\nif (raw.trim() !== \"\") {\n  let lines = raw.split('\\n');\n  for (let line of lines) {\n    if (line.trim()) {\n       try { emails.push(JSON.parse(line)); } catch(e){}\n    }\n  }\n}\nreturn { json: { emailData: JSON.stringify(emails), count: emails.length } };"
      },
      "id": "d6c6a6cd-4068-4f1e-84ff-7ade8a077935",
      "name": "è§£ææ•°æ®",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -608,
        112
      ]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.count }}",
              "operation": "larger"
            }
          ]
        }
      },
      "id": "0bb50b8c-70cc-4b45-9c3f-4ff109e5e55d",
      "name": "æ£€æŸ¥ä»Šæ—¥æ˜¯å¦æœ‰é‚®ä»¶",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -416,
        112
      ]
    },
    {
      "parameters": {
        "toRecipients": "lpz2025apply@163.com",
        "subject": "=ğŸ“Š {{ $today }}é‚®ä»¶ç²¾é€‰æ—¥æŠ¥ (22:30)",
        "bodyContent": "={{ $json.text }}",
        "additionalFields": {}
      },
      "id": "00a443d2-de9d-4e2b-ad5c-ab825a719a69",
      "name": "å‘é€ Outlook æ—¥æŠ¥",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [
        288,
        224
      ],
      "webhookId": "b20b1505-1cd8-4cf5-bb4b-14c9f726f716",
      "credentials": {
        "microsoftOutlookOAuth2Api": {
          "id": "zosb6ZPeueosMnPx",
          "name": "Microsoft Outlook account"
        }
      }
    },
    {
      "parameters": {
        "command": "rm -f /files/daily_emails.jsonl"
      },
      "id": "5ad8a36b-a771-4373-90b3-f0feb666e1ab",
      "name": "æ¸…ç©ºæš‚å­˜æ–‡ä»¶ä¸ºæ˜æ—¥å‡†å¤‡",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        656,
        96
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        -1040,
        112
      ],
      "id": "c629904a-7565-445b-8a52-c66fb442d64d",
      "name": "Date & Time1"
    },
    {
      "parameters": {
        "model": "qwen/qwen-turbo",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -160,
        304
      ],
      "id": "f976a5f7-6b28-48e8-8142-af408e736265",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "niTTJMgDXKbj44jJ",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ä»¥ä¸‹æ˜¯ä»Šå¤©æ”¶é›†åˆ°çš„å¾…åŠ/å¾…é˜…è¯»é‚®ä»¶åˆ—è¡¨ï¼ˆJSONæ ¼å¼æ•°æ®ï¼‰ã€‚è¯·ä¸ºæˆ‘ç”Ÿæˆä¸€ä»½ã€ä»Šæ—¥é‚®ä»¶ç²¾é€‰æ—¥æŠ¥ã€‘ã€‚\n\nè¦æ±‚ï¼š\n1. å¼€å¤´å†™ä¸€å¥ç®€çŸ­çš„ä»Šæ—¥æ¦‚è§ˆï¼ˆä¾‹å¦‚ä»Šå¤©æ”¶åˆ°äº†å¤šå°‘å°å€¼å¾—å…³æ³¨çš„é‚®ä»¶ï¼‰ã€‚\n2. ä¸»ä½“åˆ†ä¸ºä¸‰å¤§ä¸»é¢˜æ¿å—ï¼šğŸ’¼ **æ±‚èŒä¸æ‹›è˜ (Job)**ã€ğŸ“… **æ´»åŠ¨ä¸è®²åº§ (Activity)**ã€ğŸ“Œ **å…¶ä»–æ‚é¡¹ (Trivia)**ã€‚\n3. åœ¨æ¯ä¸ªæ¿å—å†…ï¼Œä¸¥æ ¼æŒ‰ç…§é‚®ä»¶çš„è¯„åˆ† (score) ä»é«˜åˆ°ä½æ’åˆ—ã€‚\n4. æ¯å°é‚®ä»¶çš„å±•ç¤ºæ ¼å¼å¦‚ä¸‹ï¼š\n   - **[åˆ†æ•°] æ ‡é¢˜** (å‘ä»¶äºº)\n     ğŸ’¡ ä¸€å¥è¯æ ¸å¿ƒæ€»ç»“ï¼ˆæå–æ—¶é—´ã€åœ°ç‚¹ã€è¦æ±‚æˆ–é‡ç‚¹ä¿¡æ¯ï¼Œç»ä¸å•°å—¦ï¼‰ã€‚\n5. å¦‚æœæŸä¸ªæ¿å—æ²¡æœ‰é‚®ä»¶ï¼Œè¯·ä¸è¦æ˜¾ç¤ºè¯¥æ¿å—ï¼Œæˆ–è€…ä¿çš®åœ°æç¤ºâ€œä»Šå¤©è¯¥æ¿å—ç©ºç©ºå¦‚ä¹Ÿâ€ã€‚\n\nè¿™æ˜¯ä»Šå¤©çš„é‚®ä»¶æ•°æ®ï¼š\n{{ $json.emailData }}",
        "messages": {
          "messageValues": [
            {
              "message": "ä½ æ˜¯ä¸€ä¸ªé«˜æ•ˆä¸”è´´å¿ƒçš„ç§äººåŠ©ç†ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†ä¸€å¤©ç´¯ç§¯çš„æ‚ä¹±é‚®ä»¶æ•°æ®ï¼Œæ•´ç†æˆä¸€ä»½æ¸…æ™°ã€ç¾è§‚ã€ä¸€ç›®äº†ç„¶çš„æ™šé—´é˜…è¯»æ—¥æŠ¥ã€‚è¯­æ°”è¦è‡ªç„¶ã€ä¸“ä¸šï¼Œæ’ç‰ˆå¿…é¡»ä½¿ç”¨ Markdown æ ¼å¼ï¼Œå¤šç”¨ Emoji å›¾æ ‡æ¥å¢åŠ å¯è¯»æ€§ã€‚"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.9,
      "position": [
        -160,
        96
      ],
      "id": "bc92a495-2880-4dca-a4d6-e4bd3bad4276",
      "name": "AI ç”Ÿæˆæ™šé—´æ—¥æŠ¥"
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "message:send",
        "receive_id": "ou_24d8dd986c2a1556784e00e2d4b26b9d",
        "text_content": "={{ $json.text }}",
        "options": {}
      },
      "type": "@luka-cat-mimi/n8n-nodes-feishu.feishuNode",
      "typeVersion": 1,
      "position": [
        288,
        -64
      ],
      "id": "d1dc3659-51cb-4faa-83a0-0ece8e416699",
      "name": "é‚®ç®±æ—¥æŠ¥1",
      "webhookId": "c1c3fe1e-87bf-4d80-8ca8-35c3215e5a2e",
      "credentials": {
        "feishuNodeCredentialsApi": {
          "id": "BgoHzhnosSiOSmnt",
          "name": "é£ä¹¦ç§Ÿæˆ·ç»´åº¦ account"
        }
      }
    }
  ],
  "connections": {
    "æ¯å¤© 22:30 è§¦å‘": {
      "main": [
        [
          {
            "node": "Date & Time1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–æš‚å­˜æ–‡ä»¶": {
      "main": [
        [
          {
            "node": "è§£ææ•°æ®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£ææ•°æ®": {
      "main": [
        [
          {
            "node": "æ£€æŸ¥ä»Šæ—¥æ˜¯å¦æœ‰é‚®ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ£€æŸ¥ä»Šæ—¥æ˜¯å¦æœ‰é‚®ä»¶": {
      "main": [
        [
          {
            "node": "AI ç”Ÿæˆæ™šé—´æ—¥æŠ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‘é€ Outlook æ—¥æŠ¥": {
      "main": [
        [
          {
            "node": "æ¸…ç©ºæš‚å­˜æ–‡ä»¶ä¸ºæ˜æ—¥å‡†å¤‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time1": {
      "main": [
        [
          {
            "node": "è¯»å–æš‚å­˜æ–‡ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI ç”Ÿæˆæ™šé—´æ—¥æŠ¥",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI ç”Ÿæˆæ™šé—´æ—¥æŠ¥": {
      "main": [
        [
          {
            "node": "å‘é€ Outlook æ—¥æŠ¥",
            "type": "main",
            "index": 0
          },
          {
            "node": "é‚®ç®±æ—¥æŠ¥1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "6a61b0819ff43abcea0ee93ce4487f18bd53629fda8e5628f474139c9c98638d"
  }
}
